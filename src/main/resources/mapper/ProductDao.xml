<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project1.o2o.dao.ProductDao">
	<resultMap id="productMap"
		type="com.project1.o2o.entity.Product">
		<id column="product_id" property="productId" />
		<result column="product_name" property="productName" />
		<result column="product_desc" property="productDesc" />
		<result column="img_addr" property="imgAddr" />
		<result column="normal_price" property="normalPrice" />
		<result column="sale_price" property="salePrice" />
		<result column="priority" property="priority" />
		<result column="create_time" property="createTime" />
		<result column="last_edited" property="lastEdited" />
		<result column="enable_status" property="enableStatus" />
		<association property="productCategory"
			column="product_category_id"
			javaType="com.project1.o2o.entity.ProductCategory">
			<id column="product_category_id" property="productCategoryId" />
			<result column="product_category_name"
				property="productCategoryName" />
		</association>
		<association property="shop" column="shop_id"
			javaType="com.project1.o2o.entity.Shop">
			<id column="shop_id" property="shopId" />
			<result column="owner_id" property="owner.userId" />
			<result column="shop_name" property="shopName" />
		</association>
		<collection property="productImgList" column="product_id"
			ofType="com.project1.o2o.entity.ProductImg">
			<id column="product_img_id" property="productImgId" />
			<result column="img_addr" property="imgAddr" />
			<result column="img_desc" property="imgDesc" />
			<result column="priority" property="priority" />
			<result column="create_time" property="createTime" />
			<result column="product_id" property="productId" />
		</collection>
	</resultMap>
	<insert id="insertProduct"
		parameterType="com.project1.o2o.entity.Product"
		useGeneratedKeys="true" keyProperty="productId" keyColumn="product_id">
		Insert into tb_product(product_name,product_desc,img_addr,normal_price,sale_price,priority,create_time,
		last_edited,enable_status,product_category_id,shop_id)
		Values(#{productName},#{productDesc},#{imgAddr},#{normalPrice},#{salePrice},#{priority},#{createTime},
		#{lastEdited},#{enableStatus},#{productCategory.productCategoryId},#{shop.shopId})
	</insert>
</mapper>